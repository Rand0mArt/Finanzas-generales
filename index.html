<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <meta name="theme-color" content="#050505" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="description"
    content="Finanzas Generales ‚Äî Tu app de finanzas personales. Gestiona carteras, registra gastos e ingresos, y visualiza tus finanzas." />
  <title>Finanzas Generales 2.1</title>
  <link rel="manifest" href="/Finanzas-generales/manifest.json" />
  <link rel="apple-touch-icon" href="/Finanzas-generales/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="192x192" href="/Finanzas-generales/icon-192.png">
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;0,9..40,600;0,9..40,700;1,9..40,400&display=swap"
    rel="stylesheet" />
  <script type="module" crossorigin src="/Finanzas-generales/assets/index-BysLVV8i.js"></script>
  <link rel="stylesheet" crossorigin href="/Finanzas-generales/assets/index-CVBbBJ4y.css">
</head>

<body>
  <div id="app">
    <!-- Wallet Switcher & App Header -->
    <header class="app-header" id="appHeader">
      <div class="header-top">
        <div class="user-greeting">
          <div class="user-avatar-placeholder">D</div>
          <div class="user-greeting-text">
            <span class="greeting-subtitle">Buen d√≠a,</span>
            <span class="user-name">Diego</span>
          </div>
        </div>
        <button class="icon-btn" id="notificationsToggle" aria-label="Notificaciones">
          <span class="icon">üîî</span>
        </button>
      </div>
      <div class="global-balance-container">
        <span class="global-balance-label">Liquidez Total</span>
        <span class="global-balance-amount" id="globalBalance">$0.00</span>
      </div>
      <nav class="wallet-switcher" id="walletSwitcher"></nav>
    </header>

    <!-- Main Content -->
    <main class="main-content" id="mainContent">
      <!-- Dashboard -->
      <section class="page active" id="pageDashboard">
        <div class="month-nav" id="monthNav">
          <button class="icon-btn" id="prevMonth" aria-label="Mes anterior">‚Äπ</button>
          <span class="month-label" id="monthLabel"></span>
          <button class="icon-btn" id="nextMonth" aria-label="Mes siguiente">‚Ä∫</button>
        </div>

        <div class="balance-card" id="balanceCard">
          <div class="balance-row">
            <div class="balance-item income">
              <span class="balance-label">Ingresos</span>
              <span class="balance-amount" id="totalIncome">$0</span>
            </div>
            <div class="balance-divider"></div>
            <div class="balance-item expense">
              <span class="balance-label">Gastos</span>
              <span class="balance-amount" id="totalExpense">$0</span>
            </div>
          </div>
          <div class="balance-total">
            <span class="balance-label">Balance</span>
            <span class="balance-amount" id="totalBalance">$0</span>
          </div>
        </div>

        <!-- Profit Card (business wallets only) -->
        <div class="profit-card hidden" id="profitCard">
          <div class="profit-header">
            <span class="profit-label">Utilidad del Mes</span>
            <span class="profit-margin" id="profitMargin">0%</span>
          </div>
          <span class="profit-amount" id="profitAmount">$0</span>
        </div>

        <!-- Budget Progress -->
        <div class="section-card" id="budgetSection">
          <h2 class="section-title">Presupuesto</h2>
          <div class="budget-bar-container" id="budgetBar">
            <div class="budget-bar">
              <div class="budget-fill" id="budgetFill"></div>
            </div>
            <div class="budget-labels">
              <span id="budgetSpent">$0</span>
              <span id="budgetTotal">$0</span>
            </div>
          </div>
        </div>

        <!-- Chart -->
        <div class="section-card" id="dashboardChartSection">
          <h2 class="section-title">Por Categor√≠a</h2>
          <div class="chart-container">
            <canvas id="categoryChart"></canvas>
          </div>
        </div>

        <!-- Recent Transactions -->
        <div class="section-card" id="dashboardRecentsSection">
          <div class="section-header">
            <h2 class="section-title">Recientes</h2>
            <button class="link-btn" id="viewAllTx">Ver todo ‚Üí</button>
          </div>
          <div class="transaction-list" id="recentTransactions"></div>
        </div>
      </section>

      <!-- Transactions Page -->
      <section class="page" id="pageTransactions">
        <div class="page-header">
          <div style="display:flex;align-items:center;gap:8px;">
            <button class="icon-btn back-btn" id="backFromTx">‚Äπ</button>
            <h2>Transacciones</h2>
          </div>
          <div style="display:flex;align-items:center;gap:8px;">
            <button class="icon-btn" id="sortTxBtn" style="font-size:1.2rem;">‚¨áÔ∏è</button>
          </div>
        </div>
        <div class="filter-chips" id="filterChips"></div>
        <div class="search-bar">
          <input type="text" id="searchTx" placeholder="Buscar‚Ä¶" />
        </div>
        <div class="transaction-list full" id="allTransactions"></div>
      </section>

      <!-- Goals Page -->
      <section class="page" id="pageGoals">
        <div class="section-card">
          <h2 class="section-title">Metas de Ahorro</h2>
          <div id="goalsList"></div>
        </div>
        <button class="add-debt-btn" id="addGoalBtn">+ Nueva Meta</button>
      </section>

      <!-- Accounts Page -->
      <section class="page" id="pageAccounts">
        <div class="section-card">
          <h2 class="section-title">Cuentas</h2>
          <div id="accountsList"></div>
        </div>
      </section>

      <!-- Settings Page -->
      <section class="page" id="pageSettings">
        <div class="section-card">
          <h2 class="section-title">Configuraci√≥n</h2>
          <div class="settings-group">
            <h3>Carteras</h3>
            <div id="settingsWallets"></div>
            <button class="link-btn" id="addWalletBtn">+ Agregar cartera</button>
          </div>
          <div class="settings-group">
            <h3>Datos</h3>
            <button class="settings-btn" id="exportCSV">üì§ Exportar CSV</button>
          </div>
          <div class="settings-group">
            <h3>Supabase</h3>
            <div class="input-group">
              <label>Project URL</label>
              <input type="url" id="supabaseUrl" placeholder="https://xxxx.supabase.co" />
            </div>
            <div class="input-group">
              <label>Anon Key</label>
              <input type="password" id="supabaseKey" placeholder="eyJ..." />
            </div>
            <button class="primary-btn small" id="saveSupabase">Guardar conexi√≥n</button>
          </div>
        </div>
      </section>
    </main>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav" id="bottomNav">
      <button class="nav-item active" data-page="pageDashboard">
        <span class="nav-icon">üìä</span>
        <span class="nav-label">Inicio</span>
      </button>
      <button class="nav-item" data-page="pageTransactions">
        <span class="nav-icon">üìã</span>
        <span class="nav-label">Registros</span>
      </button>
      <button class="nav-item fab-placeholder"></button>
      <button class="nav-item" data-page="pageGoals">
        <span class="nav-icon">üéØ</span>
        <span class="nav-label">Metas</span>
      </button>
      <button class="nav-item" data-page="pageSettings">
        <span class="nav-icon">‚öôÔ∏è</span>
        <span class="nav-label">Config</span>
      </button>
    </nav>

    <!-- FAB -->
    <button class="fab" id="fabAdd" aria-label="Nuevo registro">
      <span>+</span>
    </button>

    <!-- Quick Entry Modal -->
    <div class="modal-overlay" id="quickEntryModal">
      <div class="modal-sheet">
        <div class="modal-handle"></div>
        <div class="modal-header">
          <h2>Nuevo Registro</h2>
          <button class="icon-btn" id="closeModal">‚úï</button>
        </div>

        <form id="quickEntryForm" autocomplete="off">
          <!-- Type Toggle -->
          <div class="type-toggle" id="typeToggle">
            <button type="button" class="type-btn active" data-type="expense">Gasto</button>
            <button type="button" class="type-btn" data-type="income">Ingreso</button>
          </div>

          <!-- Amount -->
          <div class="amount-input-wrap">
            <span class="currency-symbol">$</span>
            <input type="number" id="entryAmount" placeholder="0.00" step="0.01" inputmode="decimal" required />
          </div>

          <!-- Description with auto-suggest -->
          <div class="input-group">
            <label>Descripci√≥n</label>
            <input type="text" id="entryDescription" placeholder="¬øEn qu√© gastaste?" />
            <div class="auto-suggest" id="autoSuggest"></div>
          </div>

          <!-- Category chips -->
          <div class="input-group">
            <label>Categor√≠a</label>
            <div class="category-chips" id="categoryChips"></div>
          </div>

          <!-- Account selector -->
          <div class="input-group">
            <label>Cuenta</label>
            <select id="entryAccount">
              <option value="">Seleccionar cuenta‚Ä¶</option>
            </select>
          </div>

          <!-- Date -->
          <div class="input-group">
            <label>Fecha</label>
            <input type="date" id="entryDate" />
          </div>

          <!-- Notes -->
          <div class="input-group">
            <label>Notas (opcional)</label>
            <textarea id="entryNotes" rows="2" placeholder="Detalles adicionales‚Ä¶"></textarea>
          </div>

          <!-- Fixed / Recurring Toggle -->
          <div class="input-group checkbox-group">
            <label class="checkbox-label">
              <input type="checkbox" id="entryFixed" />
              <span>Es gasto fijo / recurrente</span>
            </label>
          </div>

          <button type="submit" class="primary-btn" id="submitEntry">
            <span class="btn-text">Guardar</span>
            <span class="btn-loading hidden">Guardando‚Ä¶</span>
          </button>
        </form>
      </div>
    </div>

    <!-- Add Wallet Modal -->
    <div class="modal-overlay" id="addWalletModal">
      <div class="modal-sheet small">
        <div class="modal-handle"></div>
        <div class="modal-header">
          <h2>Nueva Cartera</h2>
          <button class="icon-btn close-wallet-modal">‚úï</button>
        </div>
        <form id="addWalletForm">
          <div class="input-group">
            <label>Nombre</label>
            <input type="text" id="walletName" placeholder="Mi cartera" required />
          </div>
          <div class="input-group">
            <label>Emoji</label>
            <input type="text" id="walletEmoji" placeholder="üí∞" maxlength="2" />
          </div>
          <div class="input-group">
            <label>Tipo</label>
            <select id="walletType">
              <option value="personal">Personal</option>
              <option value="business">Negocio</option>
            </select>
          </div>
          <div class="input-group">
            <label>Presupuesto mensual</label>
            <input type="number" id="walletBudget" placeholder="0" step="100" />
          </div>
          <button type="submit" class="primary-btn">Crear Cartera</button>
        </form>
      </div>
    </div>
  </div>

  <!-- Edit Wallet Modal -->
  <div class="modal-overlay" id="editWalletModal">
    <div class="modal-sheet small">
      <div class="modal-handle"></div>
      <div class="modal-header">
        <h2>Editar Cartera</h2>
        <button class="icon-btn" id="closeEditWalletModal">‚úï</button>
      </div>
      <form id="editWalletForm">
        <input type="hidden" id="editWalletId" />
        <div class="input-group">
          <label>Nombre</label>
          <input type="text" id="editWalletName" required />
        </div>
        <div class="input-group">
          <label>Emoji</label>
          <input type="text" id="editWalletEmoji" maxlength="2" />
        </div>
        <div class="input-group">
          <label>Presupuesto mensual</label>
          <input type="number" id="editWalletBudget" step="100" />
        </div>
        <div class="modal-actions">
          <button type="button" class="danger-btn" id="deleteWalletBtn">Eliminar</button>
          <button type="submit" class="primary-btn">Guardar Cambios</button>
        </div>
        <div class="mt-4">
          <button type="button" class="secondary-btn full-width" id="manageCategoriesBtn">Gestionar Categor√≠as</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Manage Categories Modal -->
  <div class="modal-overlay" id="manageCategoriesModal">
    <div class="modal-sheet">
      <div class="modal-handle"></div>
      <div class="modal-header">
        <button class="icon-btn back-btn" id="backToEditWallet">‚Äπ</button>
        <h2>Categor√≠as</h2>
        <button class="icon-btn" id="closeCategoriesModal">‚úï</button>
      </div>
      <div class="input-group">
        <form id="addCategoryForm" class="add-category-row">
          <input type="text" id="newCatEmoji" placeholder="üè∑Ô∏è" maxlength="2" class="emoji-input" required />
          <input type="text" id="newCatName" placeholder="Nueva categor√≠a" required />
          <button type="submit" class="icon-btn primary">Ôºã</button>
        </form>
      </div>
      <div class="categories-list-manage" id="manageCategoriesList">
        <!-- Categories injected here -->
      </div>
    </div>
  </div>

  <!-- Add Goal Modal -->
  <div class="modal-overlay" id="addGoalModal">
    <div class="modal-sheet small">
      <div class="modal-handle"></div>
      <div class="modal-header">
        <h2>Nueva Meta</h2>
        <button class="icon-btn close-goal-modal">‚úï</button>
      </div>
      <form id="addGoalForm" autocomplete="off">
        <div class="input-group">
          <label>Nombre</label>
          <div class="input-wrapper">
            <span class="input-icon">üéØ</span>
            <input type="text" id="goalName" placeholder="Ej. Vacaciones" required />
          </div>
        </div>
        <div class="input-group">
          <label>Tipo de Meta</label>
          <div class="input-wrapper select-wrapper">
            <span class="input-icon">üè∑Ô∏è</span>
            <select id="goalType">
              <option value="Ahorro">Ahorro</option>
              <option value="Deuda">Deuda</option>
              <option value="Inversi√≥n">Inversi√≥n</option>
            </select>
            <div class="select-indicator">‚ñº</div>
          </div>
        </div>
        <div class="input-group">
          <label>Monto Objetivo</label>
          <div class="input-wrapper">
            <span class="input-icon">üí∞</span>
            <input type="number" id="goalTarget" placeholder="0.00" step="0.01" required />
          </div>
        </div>
        <div class="input-group">
          <label>Fecha L√≠mite (Opcional)</label>
          <div class="input-wrapper">
            <span class="input-icon">üìÖ</span>
            <input type="date" id="goalDeadline" />
          </div>
        </div>
        <div class="input-group">
          <label>Icono</label>
          <div class="input-wrapper">
            <input type="text" id="goalIcon" value="üéØ" style="width:50px;text-align:center;" />
          </div>
        </div>
        <button type="submit" class="primary-btn mt-4">Crear Meta</button>
      </form>
    </div>
  </div>

  <!-- Toast -->
  <div class="toast" id="toast"></div>

</body>

</html>